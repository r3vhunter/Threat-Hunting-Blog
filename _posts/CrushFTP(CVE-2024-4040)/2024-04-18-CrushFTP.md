# What is CrushFTP

CrushFTP is designed for secure file transfers between clients and servers. CrushFTP offfers robust monitoring of server activities across networks. CVE-2024-4040 is an imporper input validation vulnerability in CrushFTP. An authenticated attacker with low privliges could exploit this vulnerabiltiy on a vulenrable CrsuhFTP server to escape the virtual file system (VFS) sandbox and access system files. 


# What Versions are affected by this?
All version before 10.7.1 and 11.1.0 of CrushFTP are vulnerable to CVE-2024-4040.


# Solution 
On April 23, CrushFTP released fixes for version 10 and version 11 of CrushFTP. 


# CrushFRP urge customers to path their servers immediately, which is understnadable since an exploit for the vulnerability was used in targeted attacks. Despite earlier communications, not even a DMZ will fully protect you and you should update immediately. 


# Detection

Payloads for (CVE-2024-4040) can be deleivered in many diferent forms. When certain evasive techniques are leveraged, payloads will be redacted from logs and request history, and malicious requests will be difficult to discern from legtimate traffic. CrushFTP users can harden their servers against administrator-level remote code execution attacks by enabling Limited Server mode and capturing log data. 

# Recommendations 

- Update CrushFTP servers to the latest version 10.7.1 or 11.0, which fixes the isses of the CVE-2024-4040 vulnerability.
- Deploy reputable endpoint protection software that includes anti-malware and behavior-based detection capabilties to identify and block suspicioius activities on endpoints.
- Implement network segmentation to isolate critical infrastructure components from other systems. This can limit lateral movement for attackers and contain potential breaches.
- Implement a robust vulnerability management process to ensure that software and systems are regulary assessed for vulknerabilties identified by security advisories and vendors to mitigate the risk of exploitation by threat actors.

# TTPs(Tactics Techniques and Procedures) 

Tactic                          Technique         Description 
Resource Development            TA0042            Stealing resources that can be used to support targeting such a infrastructure and accounts.
Execution                       TA0002            Running server-side template injection techniques 
Privilege Escalation            TA0004            Elevating their priviliges 
Vulnerabilties                  T1588.006         CrushFTP vulnerability (CVE-2024-4040) 
Command and Scripting Interpreter  T1059          Running server-side injection techniques
Exploitation for Privilege Escalation T1068       Exploiting CVE-2024-4040 to elevate privileges 






